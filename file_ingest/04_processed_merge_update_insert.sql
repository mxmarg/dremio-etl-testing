MERGE INTO "sizingtest"."<INSERT_RUN_ID_HERE>".processed_table p
USING (
    SELECT
        "managedObjectId",
        "measuringNodeId",
        "time",
        "date",
        "hour",
        "C_H111" - 10000000.0 AS "D1",
        "C_H112" - 10000000.0 AS "D2",
        "C_H113" - 10000000.0 AS "D3",
        "C_H114" - 10000000.0 AS "D4",
        "C_H115" - 10000000.0 AS "D5",
        "C_H116" - 10000000.0 AS "D6",
        "C_H117" - 10000000.0 AS "D7",
        "C_H118" - 10000000.0 AS "D8",
        "C_H119" - 10000000.0 AS "D9",
        "C_H120" - 10000000.0 AS "D10",
        "C_H121" - 10000000.0 AS "D11",
        "C_H122" - 10000000.0 AS "D12",
        "C_H123" - 10000000.0 AS "D13",
        "C_H124" - 10000000.0 AS "D14",
        "C_H125" - 10000000.0 AS "D15",
        "C_H126" - 10000000.0 AS "D16",
        "C_H127" - 10000000.0 AS "D17",
        "C_H128" - 10000000.0 AS "D18",
        "C_H129" - 10000000.0 AS "D19",
        "C_H130" - 10000000.0 AS "D20",
        "C_H101" || ' (updated)' AS "V1",
        "C_H102" || ' (updated)' AS "V2",
        "C_H103" || ' (updated)' AS "V3",
        "C_H104" || ' (updated)' AS "V4",
        "C_H105" || ' (updated)' AS "V5",
        "C_H106" || ' (updated)' AS "V6",
        "C_H107" || ' (updated)' AS "V7",
        "C_H108" || ' (updated)' AS "V8",
        "C_H109" || ' (updated)' AS "V9",
        "C_H110" || ' (updated)' AS "V10"
    FROM "sizingtest"."<INSERT_RUN_ID_HERE>".raw_table
    WHERE managedObjectId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxmo-A' AND -- One managed object has 2.24m records per day
        -- measuringNodeId = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxmn-A' AND 
        "date" = '<INSERT_DATE_HERE>' AND <INSERT_HOUR_RANGE_HERE>
) AS r
ON p."date" = r."date" AND p."hour" = r."hour" AND p."managedObjectId" = r."managedObjectId" AND p."measuringNodeId" = r."measuringNodeId" AND p."time" = r."time"
WHEN MATCHED THEN UPDATE SET
    "D1" = r."D1",
    "D2" = r."D2",
    "D3" = r."D3",
    "D4" = r."D4",
    "D5" = r."D5",
    "D6" = r."D6",
    "D7" = r."D7",
    "D8" = r."D8",
    "D9" = r."D9",
    "D10" = r."D10",
    "D11" = r."D11",
    "D12" = r."D12",
    "D13" = r."D13",
    "D14" = r."D14",
    "D15" = r."D15",
    "D16" = r."D16",
    "D17" = r."D17",
    "D18" = r."D18",
    "D19" = r."D19",
    "D20" = r."D20",
    "V1" = r."V1",
    "V2" = r."V2",
    "V3" = r."V3",
    "V4" = r."V4",
    "V5" = r."V5",
    "V6" = r."V6",
    "V7" = r."V7",
    "V8" = r."V8",
    "V9" = r."V9",
    "V10" = r."V10"
WHEN NOT MATCHED THEN INSERT (
    "managedObjectId",
    "measuringNodeId",
    "time",
    "date",
    "hour",
    "D1" ,
    "D2" ,
    "D3" ,
    "D4" ,
    "D5" ,
    "D6" ,
    "D7" ,
    "D8" ,
    "D9" ,
    "D10",
    "D11",
    "D12",
    "D13",
    "D14",
    "D15",
    "D16",
    "D17",
    "D18",
    "D19",
    "D20",
    "V1" ,
    "V2" ,
    "V3" ,
    "V4" ,
    "V5" ,
    "V6" ,
    "V7" ,
    "V8" ,
    "V9" ,
    "V10"
) VALUES (
    r."managedObjectId",
    r."measuringNodeId",
    r."time",
    r."date",
    r."hour",
    r."D1" ,
    r."D2" ,
    r."D3" ,
    r."D4" ,
    r."D5" ,
    r."D6" ,
    r."D7" ,
    r."D8" ,
    r."D9" ,
    r."D10",
    r."D11",
    r."D12",
    r."D13",
    r."D14",
    r."D15",
    r."D16",
    r."D17",
    r."D18",
    r."D19",
    r."D20",
    r."V1" ,
    r."V2" ,
    r."V3" ,
    r."V4" ,
    r."V5" ,
    r."V6" ,
    r."V7" ,
    r."V8" ,
    r."V9" ,
    r."V10"
)